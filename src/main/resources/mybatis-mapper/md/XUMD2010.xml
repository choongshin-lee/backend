<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mom.backend.XUMD2010">
    <select id="get_findBtn1" parameterType="java.util.HashMap"  resultType="com.mom.backend.dto.LowerHashMap" fetchSize="1000">
    <if test="startPage != null and startPage != '' and endPage != null and endPage != ''">
    SELECT A.*
    FROM   (
     </if>
            SELECT MI.ITEM_ID
                 , MI.ITEM_NM
                 , MI.ITEM_GROUP_CD
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0001', MI.ITEM_GROUP_CD, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS ITEM_GROUP_NM
                 , MI.ITEM_TYPE
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0002', MI.ITEM_TYPE, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS ITEM_TYPE_NM
                 , MI.ITEM_SPEC
                 , MI.UOM
                 , (SELECT MOM_COMMON_PKG.FN_GET_UNIT_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.UOM) FROM DUAL) AS UOM_NM
                 , MI.PURCHASE_UOM
                 , (SELECT MOM_COMMON_PKG.FN_GET_UNIT_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.PURCHASE_UOM) FROM DUAL) AS PURCHASE_UOM_NM
                 , MI.PURCHASE_CONVERSION_RATE 
                 , MI.PROCUREMENT_TYPE
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0004', MI.PROCUREMENT_TYPE, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS PROCUREMENT_TYPE_NM
                 , MI.MATERIAL_TYPE
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0005', MI.MATERIAL_TYPE, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS MATERIAL_TYPE_NM
                 , MI.MATERIAL_PROPERTIES
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0003', MI.MATERIAL_PROPERTIES, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS MATERIAL_PROPERTIES_NM
                 , MI.NET_WEIGHT
                 , MI.NET_WEIGHT_UOM 
                 , (SELECT MOM_COMMON_PKG.FN_GET_UNIT_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.NET_WEIGHT_UOM) FROM DUAL) AS NET_WEIGHT_UOM_NM
                 , MI.GROSS_WEIGHT
                 , MI.GROSS_WEIGHT_UOM
                 , (SELECT MOM_COMMON_PKG.FN_GET_UNIT_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.GROSS_WEIGHT_UOM) FROM DUAL) AS GROSS_WEIGHT_UOM_NM
                 , MI.STORAGE_WAREHOUSE_CD 
                 , (SELECT MOM_COMMON_PKG.FN_GET_WAREHOUSE_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.STORAGE_WAREHOUSE_CD) FROM DUAL) AS STORAGE_WAREHOUSE_NM
                 , MI.ISSUE_TYPE
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0006', MI.ISSUE_TYPE, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS ISSUE_TYPE_NM
                 , MI.SALES_UOM 
                 , (SELECT MOM_COMMON_PKG.FN_GET_UNIT_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.SALES_UOM) FROM DUAL) AS SALES_UOM_NM
                 , MI.SALES_CONVERSION_RATE 
                 , MI.MFG_UOM  
                 , (SELECT MOM_COMMON_PKG.FN_GET_UNIT_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.MFG_UOM) FROM DUAL) AS MFG_UOM_NM
                 , MI.MFG_CONVERSION_RATE 
                 , MI.IQC_FLAG
                 , MI.OQC_FLAG
                 , MI.RP_ITEM_ID
                 , MI.ITEM_CATEGORY_L
                 , MI.ITEM_CATEGORY_M
                 , MI.ITEM_CATEGORY_S
                 , MI.COLOR
                 , MI.MAKER
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0007', MI.MAKER, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS MAKER_NM
                 , MI.ABC_TYPE
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'MD0008', MI.ABC_TYPE, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS ABC_TYPE_NM
                 , MI.DRAWING_NO
                 , MI.HS_CD
                 , MI.REORDER_POINT
                 , MI.SAFETY_STOCK_QTY
                 , MI.LOT_MANAGEMENT_YN
                 , MI.PO_OVER_RECEIPT_RATE
                 , MI.PO_USER_NO     AS PO_USER_NO
                 , (SELECT MOM_COMMON_PKG.FN_GET_USER_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.PO_USER_NO) FROM DUAL ) AS PO_USER_NO_NM
                 , MI.USE_YN
                 , (SELECT MOM_COMMON_PKG.FN_GET_CODE_NAME(MI.COMPANY_CD,MI.DIVISION_CD, 'SM0001', MI.USE_YN, #{langCd, jdbcType=VARCHAR}) FROM DUAL) AS USE_YN_NM
                 , MI.DESCRIPTION
                 , MI.CREATE_BY      AS CREATE_USER_NO
                 , (SELECT MOM_COMMON_PKG.FN_GET_USER_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.CREATE_BY) FROM DUAL ) AS CREATE_USER_NM
                 , TO_CHAR(MI.CREATE_DATE,'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
                 , MI.UPDATE_BY     AS UPDATE_USER_NO   
                 , (SELECT MOM_COMMON_PKG.FN_GET_USER_NAME(MI.COMPANY_CD, MI.DIVISION_CD, MI.UPDATE_BY) FROM DUAL ) AS UPDATE_USER_NM
                 , TO_CHAR(MI.UPDATE_DATE ,'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
                 , ROWIDTOCHAR(MI.ROWID) AS GRID_ID
                 , COUNT(*) OVER() AS TOTAL_COUNT
                 , ROW_NUMBER() OVER(PARTITION BY MI.COMPANY_CD,MI.DIVISION_CD ORDER BY MI.ITEM_ID) AS ROW_CNT
                 , ROWIDTOCHAR(MI.ROWID)  AS KEY_ID
            FROM   MOM_ITEM MI
            WHERE  MI.COMPANY_CD  = #{companyCd, jdbcType=VARCHAR}
            AND    MI.DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
	        <if test="itemId != null and itemId != ''">
            AND    UPPER(MI.ITEM_ID) LIKE '%' || UPPER(#{itemId, jdbcType=VARCHAR}) || '%' 
	        </if>
	        <if test="itemNm != null and itemNm != ''">
            AND    UPPER(MI.ITEM_NM) LIKE '%' || UPPER(#{itemNm , jdbcType=VARCHAR}) || '%' 
	        </if>
	        <if test="itemType != null and itemType != ''">
            AND    MI.ITEM_TYPE IN (${itemType})
	        </if>
	        <if test="itemSpec != null and itemSpec != ''">
            AND    UPPER(MI.ITEM_SPEC) LIKE '%' || TRIM(UPPER(#{itemSpec , jdbcType=VARCHAR})) || '%' 
	        </if>
	        <if test="useYn != null and useYn != ''">
            AND    MI.USE_YN = #{useYn, jdbcType=VARCHAR}
	        </if>
	<if test="startPage != null and startPage != '' and endPage != null and endPage != ''">
	       ) A
    WHERE ROW_CNT BETWEEN #{startPage, jdbcType=INTEGER} AND #{endPage, jdbcType=INTEGER}
    </if>
    </select>
    <delete id="remove_createBtn1" parameterType="java.util.List">
    DELETE FROM MOM_PROC_ITEM
        <where>
            <foreach collection="list" item="item" open="" close="" separator="OR">
          (       COMPANY_CD  = #{item.companyCd, jdbcType=VARCHAR}
             AND  DIVISION_CD = #{item.divisionCd, jdbcType=VARCHAR}
             AND  CREATE_BY   = #{item.userId, jdbcType=VARCHAR}
          )
            </foreach>
        </where>
    </delete>  
    <insert id="create_createBtn1" parameterType="java.util.List">
        <foreach item="item" collection="list" index="i" separator=" " open="INSERT ALL" close="SELECT * FROM DUAL"> 
        INTO MOM_PROC_ITEM( COMPANY_CD
						  , DIVISION_CD
						  , ITEM_ID
						  , ITEM_NM
						  , ITEM_GROUP_CD
						  , ITEM_TYPE
						  , ITEM_SPEC
						  , UOM
						  , PURCHASE_UOM
						  , PURCHASE_CONVERSION_RATE
						  , PROCUREMENT_TYPE
						  , MATERIAL_TYPE
						  , MATERIAL_PROPERTIES
						  , NET_WEIGHT
						  , NET_WEIGHT_UOM
						  , GROSS_WEIGHT
						  , GROSS_WEIGHT_UOM
						  , STORAGE_WAREHOUSE_CD
						  , ISSUE_TYPE
						  , SALES_UOM
						  , SALES_CONVERSION_RATE
						  , MFG_UOM
						  , MFG_CONVERSION_RATE
						  , IQC_FLAG
						  , OQC_FLAG
						  , RP_ITEM_ID
						  , ITEM_CATEGORY_L
						  , ITEM_CATEGORY_M
						  , ITEM_CATEGORY_S
						  , COLOR
						  , MAKER
						  , ABC_TYPE
						  , DRAWING_NO
						  , HS_CD
						  , REORDER_POINT
						  , SAFETY_STOCK_QTY
						  , LOT_MANAGEMENT_YN
						  , PO_OVER_RECEIPT_RATE
						  , PO_USER_NO
						  , USE_YN
						  , DESCRIPTION
						  , DEL_YN
						  , VAL_MSG
						  , MULTI_MSG
						  , CREATE_BY
						  , CREATE_DATE

                          )
        VALUES            ( #{item.companyCd, jdbcType=VARCHAR}
                          , #{item.divisionCd, jdbcType=VARCHAR}
                          , #{item.itemId, jdbcType=VARCHAR}
                          , #{item.itemNm, jdbcType=VARCHAR}
                          , #{item.itemGroupCd, jdbcType=VARCHAR}
                          , #{item.itemType, jdbcType=VARCHAR}
                          , #{item.itemSpec, jdbcType=VARCHAR}
                          , #{item.uom, jdbcType=VARCHAR}
                          , #{item.purchaseUom, jdbcType=VARCHAR}
                          , #{item.purchaseConversionRate, jdbcType=NUMERIC}
                          , #{item.procurementType, jdbcType=VARCHAR}
                          , #{item.materialType, jdbcType=VARCHAR}
                          , #{item.materialProperties, jdbcType=VARCHAR}
                          , #{item.netWeight, jdbcType=NUMERIC}
                          , #{item.netWeightUom, jdbcType=VARCHAR}
                          , #{item.grossWeight, jdbcType=NUMERIC}
                          , #{item.grossWeightUom, jdbcType=VARCHAR}
                          , #{item.storageWarehouseCd, jdbcType=VARCHAR}
                          , #{item.issueType, jdbcType=VARCHAR}                          
                          , #{item.salesUom, jdbcType=VARCHAR}
                          , #{item.salesConversionRate, jdbcType=NUMERIC}                                                                                                
                          , #{item.mfgUom, jdbcType=VARCHAR}
                          , #{item.mfgConversionRate, jdbcType=VARCHAR}
                          , #{item.iqcFlag, jdbcType=VARCHAR}
                          , #{item.oqcFlag, jdbcType=VARCHAR}
                          , #{item.rpItemId, jdbcType=VARCHAR}
                          , #{item.itemCategoryL, jdbcType=VARCHAR}
                          , #{item.itemCategoryM, jdbcType=VARCHAR}
                          , #{item.itemCategoryS, jdbcType=VARCHAR}                          
                          , #{item.color, jdbcType=VARCHAR}  
                          , #{item.maker, jdbcType=VARCHAR}
                          , #{item.abcType, jdbcType=VARCHAR}
                          , #{item.drawingNo, jdbcType=VARCHAR}
                          , #{item.hsCd, jdbcType=VARCHAR}
                          , #{item.reorderPoint, jdbcType=NUMERIC}
                          , #{item.safetyStockQty, jdbcType=NUMERIC}
                          , #{item.lotManagementYn, jdbcType=VARCHAR}
                          , #{item.poOverReceiptRate, jdbcType=NUMERIC}
                          , #{item.poUserNo, jdbcType=VARCHAR}
                          , #{item.useYn, jdbcType=VARCHAR}
                          , #{item.description, jdbcType=VARCHAR}
                          , #{item.delYn, jdbcType=VARCHAR}
                          , #{item.valMsg, jdbcType=VARCHAR}
                          , #{item.multiMsg, jdbcType=VARCHAR}
                          , #{item.userId, jdbcType=VARCHAR}
                          , MOM_COMMON_PKG.FN_GET_LOCAL_TIME(#{item.companyCd, jdbcType=VARCHAR},#{item.divisionCd, jdbcType=VARCHAR})
                          )
        </foreach>
    </insert>
    <select id="proc_createBtn1" statementType="CALLABLE" parameterType="java.util.HashMap" resultType="com.mom.backend.dto.LowerHashMap">  
        { CALL MOM_MASTER_INFO_PKG.SP_UPSERT_ITEM( #{p_err_code,  jdbcType=VARCHAR, mode=OUT}
                                                 , #{p_err_msg,   jdbcType=VARCHAR, mode=OUT}
                                                 , #{companyCd,   jdbcType=VARCHAR, mode=IN}
                                                 , #{divisionCd,  jdbcType=VARCHAR, mode=IN} 
                                                 , #{actionMode,  jdbcType=VARCHAR, mode=IN}        
                                                 , #{userId,      jdbcType=VARCHAR, mode=IN} )}                    
    </select> 
    <delete id="remove_delBtn1" parameterType="java.util.List">
    DELETE FROM MOM_ITEM
        <where>
            <foreach collection="list" item="item" open="" close="" separator="OR">
	        (       COMPANY_CD = #{item.companyCd, jdbcType=VARCHAR}
	           AND  DIVISION_CD = #{item.divisionCd, jdbcType=VARCHAR}
	           AND  ITEM_ID = #{item.itemId, jdbcType=VARCHAR}
	        )
            </foreach>
        </where>
    </delete>
    <select id="get_excelUpBtn1" parameterType="java.util.HashMap"  resultType="com.mom.backend.dto.LowerHashMap" fetchSize="1000">
        SELECT NVL(VAL_MSG,'PASS') AS VAL_MSG
             , MULTI_MSG      
        FROM   MOM_PROC_ITEM
        WHERE  COMPANY_CD  = #{companyCd , jdbcType=VARCHAR}
        AND    DIVISION_CD = #{divisionCd , jdbcType=VARCHAR}
        AND    CREATE_BY    = #{userId , jdbcType=VARCHAR}
    </select> 
    <delete id="remove_excelUpBtnV1" parameterType="java.util.List">
    DELETE FROM MOM_PROC_ITEM
        <where>
            <foreach collection="list" item="item" open="" close="" separator="OR">
          (       COMPANY_CD  = #{item.companyCd, jdbcType=VARCHAR}
             AND  DIVISION_CD = #{item.divisionCd, jdbcType=VARCHAR}
             AND  CREATE_BY   = #{item.userId, jdbcType=VARCHAR}
          )
            </foreach>
        </where>
    </delete>  
    <insert id="create_excelUpBtnV1" parameterType="java.util.List">
        <foreach item="item" collection="list" index="i" separator=" " open="INSERT ALL" close="SELECT * FROM DUAL"> 
        INTO MOM_PROC_ITEM( COMPANY_CD
						  , DIVISION_CD
						  , ITEM_ID
						  , ITEM_NM
						  , ITEM_GROUP_CD
						  , ITEM_TYPE
						  , ITEM_SPEC
						  , UOM
						  , PURCHASE_UOM
						  , PURCHASE_CONVERSION_RATE
						  , PROCUREMENT_TYPE
						  , MATERIAL_TYPE
						  , MATERIAL_PROPERTIES
						  , NET_WEIGHT
						  , NET_WEIGHT_UOM
						  , GROSS_WEIGHT
						  , GROSS_WEIGHT_UOM
						  , STORAGE_WAREHOUSE_CD
						  , ISSUE_TYPE
						  , SALES_UOM
						  , SALES_CONVERSION_RATE
						  , MFG_UOM
						  , MFG_CONVERSION_RATE
						  , IQC_FLAG
						  , OQC_FLAG
						  , RP_ITEM_ID
						  , ITEM_CATEGORY_L
						  , ITEM_CATEGORY_M
						  , ITEM_CATEGORY_S
						  , COLOR
						  , MAKER
						  , ABC_TYPE
						  , DRAWING_NO
						  , HS_CD
						  , REORDER_POINT
						  , SAFETY_STOCK_QTY
						  , LOT_MANAGEMENT_YN
						  , PO_OVER_RECEIPT_RATE
						  , PO_USER_NO
						  , USE_YN
						  , DESCRIPTION
						  , DEL_YN
						  , VAL_MSG
						  , MULTI_MSG
						  , CREATE_BY
						  , CREATE_DATE

                          )
        VALUES            ( #{item.companyCd, jdbcType=VARCHAR}
                          , #{item.divisionCd, jdbcType=VARCHAR}
                          , #{item.itemId, jdbcType=VARCHAR}
                          , #{item.itemNm, jdbcType=VARCHAR}
                          , #{item.itemGroupCd, jdbcType=VARCHAR}
                          , #{item.itemType, jdbcType=VARCHAR}
                          , #{item.itemSpec, jdbcType=VARCHAR}
                          , #{item.uom, jdbcType=VARCHAR}
                          , #{item.purchaseUom, jdbcType=VARCHAR}
                          , #{item.purchaseConversionRate, jdbcType=NUMERIC}
                          , #{item.procurementType, jdbcType=VARCHAR}
                          , #{item.materialType, jdbcType=VARCHAR}
                          , #{item.materialProperties, jdbcType=VARCHAR}
                          , #{item.netWeight, jdbcType=NUMERIC}
                          , #{item.netWeightUom, jdbcType=VARCHAR}
                          , #{item.grossWeight, jdbcType=NUMERIC}
                          , #{item.grossWeightUom, jdbcType=VARCHAR}
                          , #{item.storageWarehouseCd, jdbcType=VARCHAR}
                          , #{item.issueType, jdbcType=VARCHAR}                          
                          , #{item.salesUom, jdbcType=VARCHAR}
                          , #{item.salesConversionRate, jdbcType=NUMERIC}                                                                                                
                          , #{item.mfgUom, jdbcType=VARCHAR}
                          , #{item.mfgConversionRate, jdbcType=VARCHAR}
                          , #{item.iqcFlag, jdbcType=VARCHAR}
                          , #{item.oqcFlag, jdbcType=VARCHAR}
                          , #{item.rpItemId, jdbcType=VARCHAR}
                          , #{item.itemCategoryL, jdbcType=VARCHAR}
                          , #{item.itemCategoryM, jdbcType=VARCHAR}
                          , #{item.itemCategoryS, jdbcType=VARCHAR}                          
                          , #{item.color, jdbcType=VARCHAR}  
                          , #{item.maker, jdbcType=VARCHAR}
                          , #{item.abcType, jdbcType=VARCHAR}
                          , #{item.drawingNo, jdbcType=VARCHAR}
                          , #{item.hsCd, jdbcType=VARCHAR}
                          , #{item.reorderPoint, jdbcType=NUMERIC}
                          , #{item.safetyStockQty, jdbcType=NUMERIC}
                          , #{item.lotManagementYn, jdbcType=VARCHAR}
                          , #{item.poOverReceiptRate, jdbcType=NUMERIC}
                          , #{item.poUserNo, jdbcType=VARCHAR}
                          , #{item.useYn, jdbcType=VARCHAR}
                          , #{item.description, jdbcType=VARCHAR}
                          , 'N'
                          , #{item.valMsg, jdbcType=VARCHAR}
                          , #{item.multiMsg, jdbcType=VARCHAR}
                          , #{item.userId, jdbcType=VARCHAR}
                          , MOM_COMMON_PKG.FN_GET_LOCAL_TIME(#{item.companyCd, jdbcType=VARCHAR},#{item.divisionCd, jdbcType=VARCHAR})
                          )
        </foreach>
    </insert>
    <select id="proc_excelUpBtnV1" statementType="CALLABLE" parameterType="java.util.HashMap" resultType="com.mom.backend.dto.LowerHashMap">  
        { CALL MOM_MASTER_INFO_PKG.SP_UPSERT_ITEM( #{p_err_code,  jdbcType=VARCHAR, mode=OUT}
                                                 , #{p_err_msg,   jdbcType=VARCHAR, mode=OUT}
                                                 , #{companyCd,   jdbcType=VARCHAR, mode=IN}
                                                 , #{divisionCd,  jdbcType=VARCHAR, mode=IN} 
                                                 , #{actionMode,  jdbcType=VARCHAR, mode=IN}        
                                                 , #{userId,      jdbcType=VARCHAR, mode=IN} )}                    
    </select> 
    
 
</mapper>
